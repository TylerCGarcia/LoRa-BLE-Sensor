<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LoRa-BLE-Sensor: LoRa-BLE-Sensor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LoRa-BLE-Sensor<span id="projectnumber">&#160;1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">LoRa-BLE-Sensor </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a>Hardware: LoRa-BLE-Sensor</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Overview</h1>
<p>An nRF52 and SX1262 based LoRaWAN node that uses 2 configurable sensors, each with its own configurable power supply. The firmware for this node is built around the Zephyr RTOS. ZTEST and TWISTER are used for creating and running the unit tests for the device.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Project Initialization</h1>
<p>After pulling down the repository, run the following command in the projects root directory:</p>
<div class="fragment"><div class="line">scripts/init_project.sh</div>
</div><!-- fragment --><p>This will initialize the python environment(.venv), initialize west(.west), and update west, pulling down the appropriate zephyr dependencies needed for this project. These dependencies are determined by the west manifest(west.yml) in the <code>zephyr</code> folder. The update process may take time, when finished all of the dependencies should be located in the <code>deps</code> folder. After this the <code>app</code> folder can be built and twister can be used to run the <code>tests</code> folder.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Code Breakdown</h1>
<p><b><a class="el" href="main_8c.html">main.c</a></b></p><ul>
<li>Calls functions in <b>sensor_app</b> library<ul>
<li>Switches between states for the sensor</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Power Analysis</h1>
<ul>
<li>No power analysis is done yet</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Bugs/To-Do</h1>
<ul>
<li>Add nPM1300 functionality<ul>
<li>Current, and Charge of the battery</li>
<li>Enable Charging</li>
</ul>
</li>
<li>Add NFC for BLE Configurations</li>
<li>Error handling when state given is out of bounds</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
Revision History</h1>
<p>Current Version: <b>V0.4.1</b></p>
<p>Version Breakdown: <code>[Major API Change]</code>.<code>[Minor Change/Added Functionality]</code>.<code>[Patch/bug fixes]</code></p>
<h3><a class="anchor" id="autotoc_md7"></a>
V0.4.1</h3>
<ul>
<li>Switched SDK to nRF Connect SDK V3.0.2<ul>
<li>Some functionality needed to change(e.g. resetting counter in <b><a class="el" href="sensor__timer_8h.html" title="This is a library to keep track of sensor and radio timers. Manages alarms for sensors and radio tran...">sensor_timer.h</a></b>)</li>
</ul>
</li>
<li>Cleaned code to remove compile warnings</li>
</ul>
<h3><a class="anchor" id="autotoc_md8"></a>
V0.4.0</h3>
<ul>
<li>PMIC LED is used for running an configuration state</li>
<li>PMIC battery voltage, temperature, current usb connections are added<ul>
<li>Battery voltage and battery temperature are sent over ble and lora</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md9"></a>
V0.3.0</h3>
<ul>
<li>BLE DFU is implemented using SMP Server<ul>
<li>MCUMGR is what controls this</li>
</ul>
</li>
<li>Logging for MCUBOOT is used with USB<ul>
<li>lora_ble_sensor flash partitions are edited to give mcuboot enough memory for usb logging</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md10"></a>
V0.2.2</h3>
<ul>
<li>Names for sensor types and output voltages added to their own library<ul>
<li>Relates indexes to strings to make the ble interaction more human readable</li>
</ul>
</li>
<li>MCUBOOT is added to project<ul>
<li>For later use with OTA updates</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md11"></a>
V0.2.1</h3>
<ul>
<li>Changes made for low power consumption<ul>
<li>Digital inputs changed to active low in dts</li>
<li>CONFIF_PM_DEVICE enabled</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md12"></a>
V0.2.0</h3>
<ul>
<li>version.conf file is created from git tags when device is built<ul>
<li>the code for this is in CMakeLists.txt</li>
</ul>
</li>
<li>Firmware and hardware versions added to LoRaWAN packet</li>
<li>Sensor Configurations added to LoRaWAN packet</li>
</ul>
<h3><a class="anchor" id="autotoc_md13"></a>
V0.1.0</h3>
<ul>
<li>Initial working version of the code<ul>
<li>All lorawan setup and send functionality is in place</li>
<li>Both sensors can be fully configured to VOLTAGE_SENSOR, CURRENT_SENSOR, or PULSE_SENSOR</li>
<li>Both sensors can be switched from no power, 3.3V, 5V, 6V, 12V or 24V</li>
<li>BLE functionality works for configuring the LoRaWAN and Sensors</li>
<li>Scheduling and timing system is fully working </li>
</ul>
</li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
