\doxysection{app/src/sensor\+\_\+nvs.c File Reference}
\hypertarget{sensor__nvs_8c}{}\label{sensor__nvs_8c}\index{app/src/sensor\_nvs.c@{app/src/sensor\_nvs.c}}


This is a library to keep track of sensor information and configurations that are stored in the non-\/volatile storage (NVS) of the device. nrf52840\+\_\+partition gives 32KB for storage\+\_\+partition.  


{\ttfamily \#include "{}sensor\+\_\+nvs.\+h"{}}\newline
{\ttfamily \#include $<$zephyr/fs/nvs.\+h$>$}\newline
{\ttfamily \#include $<$zephyr/logging/log.\+h$>$}\newline
{\ttfamily \#include $<$zephyr/storage/flash\+\_\+map.\+h$>$}\newline
{\ttfamily \#include $<$zephyr/drivers/flash.\+h$>$}\newline
Include dependency graph for sensor\+\_\+nvs.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sensor__nvs_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{sensor__nvs_8c_af729ab27c6be48ab7a2fa0d9779ed594}\label{sensor__nvs_8c_af729ab27c6be48ab7a2fa0d9779ed594} 
\#define {\bfseries NVS\+\_\+\+PARTITION}~storage\+\_\+partition
\item 
\Hypertarget{sensor__nvs_8c_ab3dce2e576a700556320e93eb373ed73}\label{sensor__nvs_8c_ab3dce2e576a700556320e93eb373ed73} 
\#define {\bfseries NVS\+\_\+\+PARTITION\+\_\+\+DEVICE}~FIXED\+\_\+\+PARTITION\+\_\+\+DEVICE(NVS\+\_\+\+PARTITION)
\item 
\Hypertarget{sensor__nvs_8c_a9d2e807fcd3e49aaf4c40d17a203dc01}\label{sensor__nvs_8c_a9d2e807fcd3e49aaf4c40d17a203dc01} 
\#define {\bfseries NVS\+\_\+\+PARTITION\+\_\+\+OFFSET}~FIXED\+\_\+\+PARTITION\+\_\+\+OFFSET(NVS\+\_\+\+PARTITION)
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{sensor__nvs_8c_a8b0c454d609035825f8309a7feb15500}\label{sensor__nvs_8c_a8b0c454d609035825f8309a7feb15500} 
{\bfseries LOG\+\_\+\+MODULE\+\_\+\+REGISTER} (SENSOR\+\_\+\+NVS, LOG\+\_\+\+LEVEL\+\_\+\+INF)
\item 
int \mbox{\hyperlink{sensor__nvs_8c_acd3b35314828749fb2850c5b507be010}{sensor\+\_\+nvs\+\_\+setup}} (uint8\+\_\+t nvs\+\_\+address\+\_\+count)
\begin{DoxyCompactList}\small\item\em Setup NVS for use. An enum list of addresses should be defined in application code, with the maximum number of addresses being defined. This must be called before any other NVS functions. This mounts the NVS partition and initializes it. The nvs\+\_\+address\+\_\+count will be used to know when the address is out of bounds. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sensor__nvs_8c_a24adeba9780a84e3adba4e4cc4852a82}{sensor\+\_\+nvs\+\_\+write}} (uint8\+\_\+t address, const void \texorpdfstring{$\ast$}{*}data, size\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Write given data buffer to NVS with given address. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sensor__nvs_8c_ac068b185263f41a08f176a986e2e8ffb}{sensor\+\_\+nvs\+\_\+read}} (uint8\+\_\+t address, void \texorpdfstring{$\ast$}{*}data, size\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Read data from NVS with given address, data is written to the provided buffer. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sensor__nvs_8c_af615860b9748846209f289beb45ce676}{sensor\+\_\+nvs\+\_\+delete}} (uint8\+\_\+t address)
\begin{DoxyCompactList}\small\item\em Delete data from NVS with given address. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sensor__nvs_8c_a82eb1f53f08c01bc99029213a6203dc3}{sensor\+\_\+nvs\+\_\+clear}} (void)
\begin{DoxyCompactList}\small\item\em Clear all data from NVS. NVS must be setup again after clearing. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This is a library to keep track of sensor information and configurations that are stored in the non-\/volatile storage (NVS) of the device. nrf52840\+\_\+partition gives 32KB for storage\+\_\+partition. 

\begin{DoxyAuthor}{Author}
Tyler Garcia 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2025-\/05-\/08
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (c) 2025 
\end{DoxyCopyright}


\doxysubsection{Function Documentation}
\Hypertarget{sensor__nvs_8c_a82eb1f53f08c01bc99029213a6203dc3}\label{sensor__nvs_8c_a82eb1f53f08c01bc99029213a6203dc3} 
\index{sensor\_nvs.c@{sensor\_nvs.c}!sensor\_nvs\_clear@{sensor\_nvs\_clear}}
\index{sensor\_nvs\_clear@{sensor\_nvs\_clear}!sensor\_nvs.c@{sensor\_nvs.c}}
\doxysubsubsection{\texorpdfstring{sensor\_nvs\_clear()}{sensor\_nvs\_clear()}}
{\footnotesize\ttfamily int sensor\+\_\+nvs\+\_\+clear (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Clear all data from NVS. NVS must be setup again after clearing. 

\begin{DoxyReturn}{Returns}
int 0 on success, -\/ERRNO errno code if error 
\end{DoxyReturn}
\Hypertarget{sensor__nvs_8c_af615860b9748846209f289beb45ce676}\label{sensor__nvs_8c_af615860b9748846209f289beb45ce676} 
\index{sensor\_nvs.c@{sensor\_nvs.c}!sensor\_nvs\_delete@{sensor\_nvs\_delete}}
\index{sensor\_nvs\_delete@{sensor\_nvs\_delete}!sensor\_nvs.c@{sensor\_nvs.c}}
\doxysubsubsection{\texorpdfstring{sensor\_nvs\_delete()}{sensor\_nvs\_delete()}}
{\footnotesize\ttfamily int sensor\+\_\+nvs\+\_\+delete (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{address }\end{DoxyParamCaption})}



Delete data from NVS with given address. 


\begin{DoxyParams}{Parameters}
{\em address} & address of NVS to delete \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 on success, -\/1 on error 
\end{DoxyReturn}
\Hypertarget{sensor__nvs_8c_ac068b185263f41a08f176a986e2e8ffb}\label{sensor__nvs_8c_ac068b185263f41a08f176a986e2e8ffb} 
\index{sensor\_nvs.c@{sensor\_nvs.c}!sensor\_nvs\_read@{sensor\_nvs\_read}}
\index{sensor\_nvs\_read@{sensor\_nvs\_read}!sensor\_nvs.c@{sensor\_nvs.c}}
\doxysubsubsection{\texorpdfstring{sensor\_nvs\_read()}{sensor\_nvs\_read()}}
{\footnotesize\ttfamily int sensor\+\_\+nvs\+\_\+read (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{address,  }\item[{void \texorpdfstring{$\ast$}{*}}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Read data from NVS with given address, data is written to the provided buffer. 


\begin{DoxyParams}{Parameters}
{\em address} & address of NVS to read from \\
\hline
{\em data} & pointer to data buffer to write \\
\hline
{\em length} & length of data to read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 on success, -\/1 on error 
\end{DoxyReturn}
\Hypertarget{sensor__nvs_8c_acd3b35314828749fb2850c5b507be010}\label{sensor__nvs_8c_acd3b35314828749fb2850c5b507be010} 
\index{sensor\_nvs.c@{sensor\_nvs.c}!sensor\_nvs\_setup@{sensor\_nvs\_setup}}
\index{sensor\_nvs\_setup@{sensor\_nvs\_setup}!sensor\_nvs.c@{sensor\_nvs.c}}
\doxysubsubsection{\texorpdfstring{sensor\_nvs\_setup()}{sensor\_nvs\_setup()}}
{\footnotesize\ttfamily int sensor\+\_\+nvs\+\_\+setup (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{nvs\+\_\+address\+\_\+count }\end{DoxyParamCaption})}



Setup NVS for use. An enum list of addresses should be defined in application code, with the maximum number of addresses being defined. This must be called before any other NVS functions. This mounts the NVS partition and initializes it. The nvs\+\_\+address\+\_\+count will be used to know when the address is out of bounds. 


\begin{DoxyParams}{Parameters}
{\em nvs\+\_\+address\+\_\+count} & the number of addresses to use in the NVS partition \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 on success, -\/1 on error 
\end{DoxyReturn}
\Hypertarget{sensor__nvs_8c_a24adeba9780a84e3adba4e4cc4852a82}\label{sensor__nvs_8c_a24adeba9780a84e3adba4e4cc4852a82} 
\index{sensor\_nvs.c@{sensor\_nvs.c}!sensor\_nvs\_write@{sensor\_nvs\_write}}
\index{sensor\_nvs\_write@{sensor\_nvs\_write}!sensor\_nvs.c@{sensor\_nvs.c}}
\doxysubsubsection{\texorpdfstring{sensor\_nvs\_write()}{sensor\_nvs\_write()}}
{\footnotesize\ttfamily int sensor\+\_\+nvs\+\_\+write (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{address,  }\item[{const void \texorpdfstring{$\ast$}{*}}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Write given data buffer to NVS with given address. 


\begin{DoxyParams}{Parameters}
{\em address} & address of NVS to write to \\
\hline
{\em data} & pointer to data buffer to write \\
\hline
{\em length} & length of data to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 on success, -\/1 on error 
\end{DoxyReturn}
