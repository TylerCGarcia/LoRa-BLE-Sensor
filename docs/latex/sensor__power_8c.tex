\doxysection{app/src/sensor\+\_\+power.c File Reference}
\hypertarget{sensor__power_8c}{}\label{sensor__power_8c}\index{app/src/sensor\_power.c@{app/src/sensor\_power.c}}


This is a library for sensor power configurations and control. This is manages the power configuration, pin configuration, and control of sensor power.  


{\ttfamily \#include "{}sensor\+\_\+power.\+h"{}}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$zephyr/kernel.\+h$>$}\newline
{\ttfamily \#include $<$zephyr/drivers/gpio.\+h$>$}\newline
{\ttfamily \#include $<$zephyr/drivers/regulator.\+h$>$}\newline
{\ttfamily \#include $<$zephyr/drivers/adc.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$zephyr/logging/log.\+h$>$}\newline
Include dependency graph for sensor\+\_\+power.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sensor__power_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{sensor__power_8c_a055a8d69d8aa3d02b67e96a19b7182f5}\label{sensor__power_8c_a055a8d69d8aa3d02b67e96a19b7182f5} 
{\bfseries LOG\+\_\+\+MODULE\+\_\+\+REGISTER} (sensor\+\_\+power, LOG\+\_\+\+LEVEL\+\_\+\+INF)
\item 
int \mbox{\hyperlink{sensor__power_8c_a635726c5da52d9e426385e46461510a4}{set\+\_\+sensor\+\_\+output}} (\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}config, enum \mbox{\hyperlink{sensor__id_8h_adef9477a37671049d57edb26e6a37746}{sensor\+\_\+voltage}} voltage)
\begin{DoxyCompactList}\small\item\em Set the sensor voltage for an output, enabling/disabling the correct regulators, and setting the correct gpios. When setting the voltage to OFF the voltage may take 1-\/2 seconds to fully turn off, due to capacitors on the output. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sensor__power_8c_af0fef1d3475ac0c0f02759e1384fc550}{sensor\+\_\+power\+\_\+init}} (\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}config)
\begin{DoxyCompactList}\small\item\em Initialize a sensor\+\_\+power\+\_\+setup. This sets the id of the output, the gpios beings used and the regulator device being used. After configurations are set, the sensors output is set OFF. \end{DoxyCompactList}\item 
enum \mbox{\hyperlink{sensor__id_8h_adef9477a37671049d57edb26e6a37746}{sensor\+\_\+voltage}} \mbox{\hyperlink{sensor__power_8c_a43c8fa6a693ff0e093fcbb347d8e8b35}{get\+\_\+sensor\+\_\+output}} (\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}config)
\begin{DoxyCompactList}\small\item\em Get the sensor voltage that is set for an output. \end{DoxyCompactList}\item 
float \mbox{\hyperlink{sensor__power_8c_ab807eed06a3e1579a7fa930c582df33a}{read\+\_\+sensor\+\_\+output}} (\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}config)
\begin{DoxyCompactList}\small\item\em Read the voltage output of the selected sensor power configuration. Takes into account resistor divider on output. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sensor__power_8c_a3e23b3ad1ab7f243f5b3041e4974e101}{validate\+\_\+output}} (\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}config, enum \mbox{\hyperlink{sensor__id_8h_adef9477a37671049d57edb26e6a37746}{sensor\+\_\+voltage}} voltage, uint8\+\_\+t accepted\+\_\+error)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const float \mbox{\hyperlink{sensor__power_8c_a28beff681a53d5e930e42a4d48c9e340}{sensor\+\_\+voltage\+\_\+values}} \mbox{[}$\,$\mbox{]}
\item 
\Hypertarget{sensor__power_8c_a743a784c21d46f951b2bb9ae7ab0c76a}\label{sensor__power_8c_a743a784c21d46f951b2bb9ae7ab0c76a} 
enum \mbox{\hyperlink{sensor__id_8h_adef9477a37671049d57edb26e6a37746}{sensor\+\_\+voltage}} {\bfseries sensor\+\_\+state} \mbox{[}SENSOR\+\_\+\+POWER\+\_\+\+INDEX\+\_\+\+LIMIT\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This is a library for sensor power configurations and control. This is manages the power configuration, pin configuration, and control of sensor power. 

\begin{DoxyAuthor}{Author}
Tyler Garcia 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2025-\/05-\/09
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (c) 2025 
\end{DoxyCopyright}


\doxysubsection{Function Documentation}
\Hypertarget{sensor__power_8c_a43c8fa6a693ff0e093fcbb347d8e8b35}\label{sensor__power_8c_a43c8fa6a693ff0e093fcbb347d8e8b35} 
\index{sensor\_power.c@{sensor\_power.c}!get\_sensor\_output@{get\_sensor\_output}}
\index{get\_sensor\_output@{get\_sensor\_output}!sensor\_power.c@{sensor\_power.c}}
\doxysubsubsection{\texorpdfstring{get\_sensor\_output()}{get\_sensor\_output()}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{sensor__id_8h_adef9477a37671049d57edb26e6a37746}{sensor\+\_\+voltage}} get\+\_\+sensor\+\_\+output (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{config }\end{DoxyParamCaption})}



Get the sensor voltage that is set for an output. 


\begin{DoxyParams}{Parameters}
{\em config} & \doxylink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t} sensor power configuration for the current sensor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
enum sensor\+\_\+voltage for selected sensor configuration 
\end{DoxyReturn}
\Hypertarget{sensor__power_8c_ab807eed06a3e1579a7fa930c582df33a}\label{sensor__power_8c_ab807eed06a3e1579a7fa930c582df33a} 
\index{sensor\_power.c@{sensor\_power.c}!read\_sensor\_output@{read\_sensor\_output}}
\index{read\_sensor\_output@{read\_sensor\_output}!sensor\_power.c@{sensor\_power.c}}
\doxysubsubsection{\texorpdfstring{read\_sensor\_output()}{read\_sensor\_output()}}
{\footnotesize\ttfamily float read\+\_\+sensor\+\_\+output (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{config }\end{DoxyParamCaption})}



Read the voltage output of the selected sensor power configuration. Takes into account resistor divider on output. 


\begin{DoxyParams}{Parameters}
{\em config} & \doxylink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t} sensor power configuration for the current sensor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
float output of the sensor power system 
\end{DoxyReturn}
\Hypertarget{sensor__power_8c_af0fef1d3475ac0c0f02759e1384fc550}\label{sensor__power_8c_af0fef1d3475ac0c0f02759e1384fc550} 
\index{sensor\_power.c@{sensor\_power.c}!sensor\_power\_init@{sensor\_power\_init}}
\index{sensor\_power\_init@{sensor\_power\_init}!sensor\_power.c@{sensor\_power.c}}
\doxysubsubsection{\texorpdfstring{sensor\_power\_init()}{sensor\_power\_init()}}
{\footnotesize\ttfamily int sensor\+\_\+power\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{config }\end{DoxyParamCaption})}



Initialize a sensor\+\_\+power\+\_\+setup. This sets the id of the output, the gpios beings used and the regulator device being used. After configurations are set, the sensors output is set OFF. 


\begin{DoxyParams}{Parameters}
{\em config} & \doxylink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t} sensor power configuration for the current sensor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int -\/1 if error setting up power system or adc 
\end{DoxyReturn}
\Hypertarget{sensor__power_8c_a635726c5da52d9e426385e46461510a4}\label{sensor__power_8c_a635726c5da52d9e426385e46461510a4} 
\index{sensor\_power.c@{sensor\_power.c}!set\_sensor\_output@{set\_sensor\_output}}
\index{set\_sensor\_output@{set\_sensor\_output}!sensor\_power.c@{sensor\_power.c}}
\doxysubsubsection{\texorpdfstring{set\_sensor\_output()}{set\_sensor\_output()}}
{\footnotesize\ttfamily int set\+\_\+sensor\+\_\+output (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{config,  }\item[{enum \mbox{\hyperlink{sensor__id_8h_adef9477a37671049d57edb26e6a37746}{sensor\+\_\+voltage}}}]{voltage }\end{DoxyParamCaption})}



Set the sensor voltage for an output, enabling/disabling the correct regulators, and setting the correct gpios. When setting the voltage to OFF the voltage may take 1-\/2 seconds to fully turn off, due to capacitors on the output. 


\begin{DoxyParams}{Parameters}
{\em config} & \doxylink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t} sensor power configuration for the current sensor \\
\hline
{\em voltage} & enum sensor\+\_\+voltage setting selected \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 if successful, sets voltage to OFF if invalid voltage input 
\end{DoxyReturn}
\Hypertarget{sensor__power_8c_a3e23b3ad1ab7f243f5b3041e4974e101}\label{sensor__power_8c_a3e23b3ad1ab7f243f5b3041e4974e101} 
\index{sensor\_power.c@{sensor\_power.c}!validate\_output@{validate\_output}}
\index{validate\_output@{validate\_output}!sensor\_power.c@{sensor\_power.c}}
\doxysubsubsection{\texorpdfstring{validate\_output()}{validate\_output()}}
{\footnotesize\ttfamily int validate\+\_\+output (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{config,  }\item[{enum \mbox{\hyperlink{sensor__id_8h_adef9477a37671049d57edb26e6a37746}{sensor\+\_\+voltage}}}]{voltage,  }\item[{uint8\+\_\+t}]{accepted\+\_\+error }\end{DoxyParamCaption})}


\begin{DoxyParams}{Parameters}
{\em config} & \doxylink{structsensor__power__config__t}{sensor\+\_\+power\+\_\+config\+\_\+t} sensor power configuration for the current sensor \\
\hline
{\em voltage} & enum sensor\+\_\+voltage setting selected \\
\hline
{\em accepted\+\_\+error} & error in percent that the device is allowed to be off by \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 if successful, -\/1 if not 
\end{DoxyReturn}


\doxysubsection{Variable Documentation}
\Hypertarget{sensor__power_8c_a28beff681a53d5e930e42a4d48c9e340}\label{sensor__power_8c_a28beff681a53d5e930e42a4d48c9e340} 
\index{sensor\_power.c@{sensor\_power.c}!sensor\_voltage\_values@{sensor\_voltage\_values}}
\index{sensor\_voltage\_values@{sensor\_voltage\_values}!sensor\_power.c@{sensor\_power.c}}
\doxysubsubsection{\texorpdfstring{sensor\_voltage\_values}{sensor\_voltage\_values}}
{\footnotesize\ttfamily const float sensor\+\_\+voltage\+\_\+values\mbox{[}$\,$\mbox{]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ [SENSOR\_VOLTAGE\_OFF]\ =\ 2.75,}
\DoxyCodeLine{\ \ \ \ [SENSOR\_VOLTAGE\_3V3]\ =\ 3.3,}
\DoxyCodeLine{\ \ \ \ [SENSOR\_VOLTAGE\_5V]\ \ =\ 5.0,}
\DoxyCodeLine{\ \ \ \ [SENSOR\_VOLTAGE\_6V]\ \ =\ 6.0,}
\DoxyCodeLine{\ \ \ \ [SENSOR\_VOLTAGE\_12V]\ =\ 12.0,}
\DoxyCodeLine{\ \ \ \ [SENSOR\_VOLTAGE\_24V]\ =\ 24.0,}
\DoxyCodeLine{\}}

\end{DoxyCode}
